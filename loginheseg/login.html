<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>zuv</title>
  <link rel="stylesheet" href="./login.css">
  
</head>
<body>
  
  
<div class="HomeMainContainer">
  <div class="bubbles">
    <span style="--i:11;"></span>
    <span style="--i:12;"></span> 
    <span style="--i:24;"></span> 
    <span style="--i:10;"></span>
    <span style="--i:14;"></span>
    <span class="baihgui" style="--i:23;"></span>
    <span class="baihgui" style="--i:16;"></span>
    <span class="baihgui" style="--i:19;"></span>
    <span class="baihgui" style="--i:20;"></span>
    <span class="baihgui" style="--i:22;"></span>
    <span class="baihgui" style="--i:25;"></span>
    <span class="baihgui" style="--i:21;"></span>
    <span class="baihgui" style="--i:11;"></span>
    <span class="baihgui" style="--i:12;"></span> 
    <span class="baihgui" style="--i:24;"></span> 
    <span class="baihgui" style="--i:10;"></span>
    <span class="baihgui" style="--i:14;"></span>
    <span class="baihgui" style="--i:23;"></span>
    <span class="baihgui" style="--i:16;"></span>
    <span class="baihgui" style="--i:19;"></span>
    <span class="baihgui" style="--i:20;"></span>
    <span class="baihgui" style="--i:22;"></span>
    <span class="baihgui" style="--i:25;"></span>
    <span class="baihgui" style="--i:21;"></span>
    <span class="baihgui" style="--i:15;"></span>
    <span class="baihgui" style="--i:11;"></span>
    <span class="baihgui" style="--i:12;"></span> 
    <span class="baihgui" style="--i:24;"></span> 
    <span style="--i:10;"></span>
    <span style="--i:14;"></span>
    <span style="--i:23;"></span>
    <span style="--i:16;"></span>
    <span style="--i:19;"></span>
    
   
</div>
  <div class="nevtrehHeseg">
    <div class="logoHeseg">
        <div class="logoNevtreh">
            <img src="https://president.mn/wp-content/uploads/2021/11/1-Copy.png" alt="">
        </div>
    </div>
    <div class="nevtrehUg">
        <h3>Нэвтрэх</h3>
    </div>
    <div class="burtgeljuuleh">
        <div class="burtgeljuulehMain">
            <div class="username">
                <label for="username">Email Хаягаа Оруулна уу</label>
                <input type="email"  id="email">
            </div>
            <div class="password">
              <div class="passwordUg">
                  <p>Нууц Үг</p>
              </div>
              <input type="password"  id="password">
            </div>
            <button id="nevtreh">Нэвтрэх</button>
        </div>
    </div>
    <div class="shineBurtgel">
        <p>Шинэ бүртгэл үүсгэх үү?</p>
        <p class="burtguulehUg" >Бүртгүүлэх</p>
    </div>
   
  </div>


<!-- Бүртгэл хэсэг -->
  <div class="burtguulehHeseg">
      <div class="logoHeseg">
          <div class="logoNevtreh">
              <img src="https://president.mn/wp-content/uploads/2021/11/1-Copy.png" alt="">
          </div>
      </div>
  <div class="burtgelug">
      <h3>Бүртгүүлэх</h3>
   </div>
   <div class="huviHunEsvelBaiguulaga">
      <button id="huvihun">Хувь хүн</button><button id="baiguulaga">Албан байгуулага</button>
  </div>
  <div id="baiguulagiinNerHeseg">
      <label>Байгуулагын нэр</label>
      <input type="text" id="baiguulagaNer" name="">
  </div>
   <div class="ovogniiHeseg">
       <label for="ovog">Овог</label>
       <input type="text" id="ovog" >
   </div>
   <div class="nerniiHeseg">
      <label for="ner">Нэр</label>
      <input type="text" id="ner" >
   </div>
   <div class="emailHeseg">
      <label for="email">Email хаягаа оруулна уу?</label>
       <input type="email"  id="email1" >
   </div>
   <div class="passwordHeseg">
      <label for="password">Password-oo оруулна уу?</label>
      <input type="password"  id="password1">
   </div>
   <div class="burtguulehButton">
       <button id="burtguuleh">Бүртгүүлэх</button>
   </div>
   <div style="width: 100%;
   height: 20%;display: flex;justify-content: center;
   align-items: center;text-align: center;">
    <span id="nevtrehButsah">Бүртгэлтэй бол Нэвтрэх</span>
   </div>
  </div>
</div>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenLite.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TimelineLite.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/CSSPlugin.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/BezierPlugin.min.js"></script>

 
  <script src="./loginstyle.js"></script>
  <script type="module" >
      import {
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    signOut,
    updateEmail,
    updatePassword,
    sendEmailVerification
  } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js";
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    getDocs,
    addDoc,
    getDoc,
    setDoc,
    doc,
    updateDoc,
    increment,
  } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore.js";
  import {
    getDatabase,
    onValue,
    ref,
    push,
    query,
    orderByChild,
    orderByKey,
    child,
    set,
    get,
    onChildChanged,
  } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
  
 const firebaseConfig = {
  apiKey: "AIzaSyDgYAy6FkKAJ2_0e07Xh8LhzYOpP1ra9Q8",
  authDomain: "demo1-1ee9d.firebaseapp.com",
  databaseURL: "https://demo1-1ee9d-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "demo1-1ee9d",
  storageBucket: "demo1-1ee9d.appspot.com",
  messagingSenderId: "247353066341",
  appId: "1:247353066341:web:4b8f133a68a3d85679578c",
  measurementId: "G-5N6BTMR62T"
};

  
  const app = initializeApp(firebaseConfig);
  const auth=getAuth(app);
  const db=getFirestore(app);
  const realDb=getDatabase(app);
  
  //бүртгүүлэх
  const createUser=async()=>{
    console.log("Signup");
    let email=document.getElementById('email1').value;
    let password=document.getElementById('password1').value;
    let ovog=document.getElementById("ovog").value;
    let ner=document.getElementById("ner").value;
    let baiguulaganer=document.getElementById("baiguulagaNer").value;
    console.log(document.getElementById("baiguulagiinNerHeseg"))
   
// Бүртгэл үүсгэж хэрэглэгчийн UID гаар doc үүсгэнэ
//Хувь хүнээр хаяг үүсгэнэ
if((document.getElementById("baiguulagiinNerHeseg").style.display==="none")){
  
  
        createUserWithEmailAndPassword(auth,email,password)
      .then(async(userCredential)=>{
        console.log(userCredential)
        const userUidFromCred=userCredential.user.uid;
        console.log(userUidFromCred);
          await setDoc(doc(db,"huviHun",userUidFromCred,),{
          ovog:ovog,
          ner:ner,
          email:email,
          niitmod:0,
          userUid:userUidFromCred
        });
          await swal("Амжилттай нэвтэрлээ");
          location.href = "../profile/index.html";
        
        
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.log(errorCode, errorMessage);
        alert("Нэвтрэх нэр эсвэл нууц үг буруу байна")
      })  
 }
//Байгуулагаар хаяг үүсгэнэ
        if((document.getElementsByClassName("ovogniiHeseg")[0].style.display==="none")&&(document.getElementsByClassName("nerniiHeseg")[0].style.display==="none")){
          console.log("hello");
              createUserWithEmailAndPassword(auth,email,password)
            .then(async(userCredential)=>{
              console.log(userCredential)
              const userUidFromCred=userCredential.user.uid;
              
                await setDoc(doc(db,"baiguulaga",userUidFromCred,),{
                baiguulaganer:baiguulaganer,
                email:email,
                niitmod:0,
                userUid:userUidFromCred
              });
                await swal("Амжилттай нэвтэрлээ");
                location.href = "../profile/index.html";
              // location.href = "modBurtgel.html";
               
            })
            .catch((error) => {
              const errorCode = error.code;
              const errorMessage = error.message;
              console.log(errorCode, errorMessage);
              alert("Нэвтрэх нэр эсвэл нууц үг буруу байна")  
             })

     }

  }




  //nevtreh
  const login=async()=>{
    const email=document.getElementById("email").value;
    const password=document.getElementById("password").value;
  
    signInWithEmailAndPassword(auth,email,password)
    signInWithEmailAndPassword(auth, email, password)
      .then(async(userCredential) => {
        // Signed in
        let userUid = userCredential.user.uid;
        console.log("amjilttai newterlee uid= ", userUid);
        // window.location.href = "./profileHeseg/.profile.html";
        console.log(auth.currentUser.email);
        await swal("Амжилттай нэвтэрлээ");
        location.href = "../profile/index.html";
      
       
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.log(errorCode, errorMessage);
      });
  }
  // burtguuleh болон nevtreh товч дарж Функц ажиллуулна
  document.getElementById('burtguuleh').addEventListener('click',createUser);
  document.getElementById("nevtreh").addEventListener("click",async()=>{
const emailInput=document.getElementById("email").value;
    console.log(document.getElementById("email").value.length);
    let temp=emailInput.split("@");
    let ext=temp.slice(temp.length-1,temp.length);
    console.log(ext[0]);
    if(ext[0]==="yahoo.com" || ext[0]==="gmail.com")
    {
     await login();
     
    }else{
      swal("Нэвтрэх хаяг буруу байна")
    }
    
  });
  </script>
</body>
</html>