<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tree</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lobster&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- header heseg ++++++++-->
    <div class="header-heseg">
      <div class="header">
        <div class="logo">
          <img
            src="https://raw.githubusercontent.com/mairadn/treedemo/main/logo.png"
            alt="logo"
          />
          <div>
            <p style="color: #04a74b">ТЭРБУМ МОД</p>
            <p style="color: #314f9b">Үндэсний Хөдөлгөөн</p>
          </div>
        </div>
      </div>
      <div class="humburger">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="huudsuud">
          <a href="../index.html">Нүүр хуудас</a>
          <a href="../statis/index.html">Статистик</a>
          <a href="../profile/index.html">Профайл</a>
          <a href="">Мэдээ</a>
          <a href="../zuvluguu/index.html">Зөвөлгөө</a>
        </div>
      </div>
      <div class="bar">
        <div class="torol">
          <div class="garchig">
            <a href="../index.html">Нүүр хуудас</a>
          </div>
          <div class="garchig">
            <a href="../statis/index.html">Статистик</a>
          </div>
          <div class="garchig">
            <a href="../profile/index.html">Профайл</a>
          </div>
          <div class="garchig">
            <a href="../modBurtgeljuulehHeseg/modBurtgel.html"
              >Тарисан модны бүртгэл</a
            >
          </div>
          <div class="garchig">
            <a href="">Мэдээ</a>
          </div>
          <div class="garchig">
            <a href="../zuvluguu/index.html">Зөвөлгөө</a>
          </div>
        </div>
      </div>
    </div>
    <!-- header heseg ++++++++-->

    <!-- profile heseg -->

    <div class="contentProfile">
      <div class="talarhaliinPart">
        <img
          id="thanksgif"
          src="https://i.pinimg.com/originals/96/14/fa/9614fa802daad49000f79cc1fec29689.gif"
          alt=""
        />
        <div class="talarhal">
          <h3>Талархал</h3>
          <p>
            Дэлхий нийтийн өмнө тулгараад буй уур амьсгалын өөрчлөлт дэлхийн
            дулаарал, цөлжилттэй тэмцэх чиглэлд гаргасан томоохон санал,
            санаачилга болох “Тэрбум мод” үндэсний хөдөлгөөнд нэгдэж мод тарьж
            ургуулж байгаа таньд талархалаа.
          </p>
        </div>
      </div>

      <h1 class="profilemember">ГИШҮҮНИЙ ПРОФАЙЛ</h1>

      <div class="profileMain">
        <div class="modniizurag">
          <img
            id="tomMod"
            src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/87fb72ad-f111-458e-8773-c00d6dc51d92/dcamutq-b0ac99f9-9f45-45a1-a1e0-4b4576561d44.gif?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzg3ZmI3MmFkLWYxMTEtNDU4ZS04NzczLWMwMGQ2ZGM1MWQ5MlwvZGNhbXV0cS1iMGFjOTlmOS05ZjQ1LTQ1YTEtYTFlMC00YjQ1NzY1NjFkNDQuZ2lmIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0.TmYfK-XWQtl56RYnfVMloNfzm25QlE9rP2RzXE04uZE"
            alt=""
          />
          <img
            id="svgMod"
            src="https://freesvg.org/img/tree_21102016.png"
            alt=""
          />
          <img
            id="svgModArd"
            src="https://freesvg.org/img/tree-17.png"
            alt=""
          />
          <img id="goyMod" src="https://freesvg.org/img/ete.png" alt="" />
          <img
            id="svgGrass"
            src="https://freesvg.org/img/1457805025.png"
            alt=""
          />
          <img
            id="gifGrass"
            src="https://www.victoriamemorial-cal.org/uploads/E-Catalogue-List/butter.gif"
            alt=""
          />
        </div>

        <div class="memberPart">
          <div class="profileZurag">
            <div class="profileZurag-anima"></div>
            <div class="memberZurag">
              <img src="https://source.unsplash.com/random?/forest" />
            </div>
          </div>

          <div>
            <span id="memberName">Хэрэглэгчийн нэр</span>
            <span id="emailAdress"
              >Email: <span id="emailNer">kadaha</span>
            </span>

            <button id="addTree">
              <a
                style="
                  text-decoration: none;
                  color: #edeeee;
                  text-align: center;
                "
                href=""
              >
                <div class="modNemeh">
                  <div style="margin-left: 10px">Мод Нэмэх</div>
                  <div class="nemeh">+</div>
                </div>
              </a>
            </button>

            <span id="treeNumber"
              >Тарисан модны тоо: <span id="tooshirhegPro">0</span>
            </span>

            <div style="display: flex; position: absolute; bottom: 4%">
              <div class="graphic">
                <canvas id="myChart"></canvas>
              </div>

              <div class="miniiTarisanModniiContainer"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- profile heseg -->

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenLite.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TimelineLite.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/CSSPlugin.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/BezierPlugin.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";

      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        signOut,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js";

      import {
        getStorage,
        ref as sRef,
        uploadBytes,
        uploadBytesResumable,
      } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-storage.js";

      import {
        getFirestore,
        collection,
        getDocs,
        addDoc,
        getDoc,
        setDoc,
        doc,
        updateDoc,
        increment,
      } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore.js";

      import {
        getDatabase,
        onValue,
        ref,
        push,
        query,
        orderByChild,
        orderByKey,
        child,
        set,
        get,
        onChildChanged,
      } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDgYAy6FkKAJ2_0e07Xh8LhzYOpP1ra9Q8",
        authDomain: "demo1-1ee9d.firebaseapp.com",
        databaseURL:
          "https://demo1-1ee9d-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "demo1-1ee9d",
        storageBucket: "demo1-1ee9d.appspot.com",
        messagingSenderId: "247353066341",
        appId: "1:247353066341:web:4b8f133a68a3d85679578c",
        measurementId: "G-5N6BTMR62T",
      };

      let miniiModniiTorliinNer = [];
      let miniiModniiTorliinToo = [];
      let backgroundColor = [];
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      const realDb = getDatabase(app);
      const storage = getStorage(app);
      onAuthStateChanged(auth, async (user) => {
        if (user) {
          console.log("hello1");
          // document.getElementById("nevtreh").style.display='none';
          // document.getElementById("garah").style.display="block"
          const userUid = user.uid;
          console.log(userUid, auth.currentUser.uid);
          if (auth.currentUser.uid === userUid);
          {
            console.log("adilhan baina");
            ///huvihunesehiig shalgana
            const huviHunEseh = await getDocs(collection(db, "huviHun"));
            //baiguulaga esehiig shalgana
            const baiguulagaEseh = await getDocs(collection(db, "baiguulaga"));

            huviHunEseh.forEach(async (huviHun) => {
              console.log(huviHun.data(), userUid);

              if (huviHun.data().userUid === userUid) {
                await console.log("huviHun", huviHun.data());
                document.getElementById("memberName").innerText =
                  huviHun.data().ner;
                document.getElementById("emailNer").innerText =
                  huviHun.data().email;
                document.getElementById("tooshirhegPro").innerText =
                  huviHun.data().niitmod;

                const miniitarisanmodnuudTorloor = await getDocs(
                  collection(db, "huviHun", userUid, "modniiTorloor")
                );
                miniitarisanmodnuudTorloor.forEach(async (modTorol) => {
                  await console.log(modTorol.id);
                  await miniiModniiTorliinNer.push(modTorol.id);
                  await miniiModniiTorliinToo.push(modTorol.data().niitmod);
                  await console.log(miniiModniiTorliinToo[0]);
                  for (let i = 0; i < miniiModniiTorliinNer.length; i++) {
                    const randomColor = Math.floor(
                      Math.random() * 16777215
                    ).toString(16);
                    const randomColorCode = "#" + randomColor;
                    backgroundColor.push(randomColorCode);
                  }
                  const myChart = new Chart(ctx, {
                    type: "doughnut",
                    data: {
                      labels: miniiModniiTorliinNer,
                      datasets: [
                        {
                          label: "# of Votes",
                          data: miniiModniiTorliinToo,
                          backgroundColor: backgroundColor,

                          borderColor: [
                            "rgba(255, 99, 132, 1)",
                            "rgba(54, 162, 235, 1)",
                          ],
                          borderWidth: 1,
                        },
                      ],
                    },
                    options: {
                      scales: {
                        y: {
                          beginAtZero: true,
                        },
                      },
                    },
                  });
                  const miniiTarisanModContainer =
                    document.getElementsByClassName(
                      "miniiTarisanModniiContainer"
                    )[0];
                  console.log(miniiTarisanModContainer);

                  const miniitarisanmodnuud = await getDocs(
                    collection(db, "huviHun", userUid, "miniitarisanmodnuud")
                  );
                  miniitarisanmodnuud.forEach(async (miniiMod) => {
                    await console.log(miniiMod.data());
                    let modnuud = "";

                    modnuud = `
                                          <div class="modniiTuhai">
                                            <p id="onsarPro" >${
                                              miniiMod.data().HezeeTarisan
                                            }</p>
                                            <p class="YmarMod">${
                                              miniiMod.data().modniitorol
                                            }</p>
                                            <p class="HedenShirheg">${
                                              miniiMod.data().niithedenShirheg
                                            } ширхэг
                                            </p>
                                            <p class="HaanaTariv"> ${
                                              miniiMod.data().haana
                                            }</p>
                                         </div>
                                         `;
                    await console.log(modnuud);
                    miniiTarisanModContainer.innerHTML += modnuud;
                  });
                });
              }
            });

            baiguulagaEseh.forEach(async (baiguulaga) => {
              if (baiguulaga.data().userUid === userUid) {
                console.log("baiguulaga", baiguulaga.data().userUid, userUid);
                document.getElementById("memberName").innerText =
                  baiguulaga.data().ner;
                document.getElementById("emailNer").innerText =
                  baiguulaga.data().email;
                document.getElementById("tooshirhegPro").innerText =
                  baiguulaga.data().niitmod;

                const miniitarisanmodnuudTorloor = await getDocs(
                  collection(db, "baiguulaga", userUid, "modniiTorloor")
                );
                miniitarisanmodnuudTorloor.forEach(async (modTorol) => {
                  await console.log(modTorol.id);
                  await miniiModniiTorliinNer.push(modTorol.id);
                  await miniiModniiTorliinToo.push(modTorol.data().niitmod);
                  await console.log(miniiModniiTorliinToo[0]);
                  for (let i = 0; i < miniiModniiTorliinNer.length; i++) {
                    const randomColor = Math.floor(
                      Math.random() * 16777215
                    ).toString(16);
                    const randomColorCode = "#" + randomColor;
                    backgroundColor.push(randomColorCode);
                  }
                  const myChart = new Chart(ctx, {
                    type: "doughnut",
                    data: {
                      labels: miniiModniiTorliinNer,
                      datasets: [
                        {
                          label: "# of Votes",
                          data: miniiModniiTorliinToo,
                          backgroundColor: backgroundColor,

                          borderColor: [
                            "rgba(255, 99, 132, 1)",
                            "rgba(54, 162, 235, 1)",
                          ],
                          borderWidth: 1,
                        },
                      ],
                    },
                    options: {
                      scales: {
                        y: {
                          beginAtZero: true,
                        },
                      },
                    },
                  });
                  const miniiTarisanModContainer =
                    document.getElementsByClassName(
                      "miniiTarisanModniiContainer"
                    )[0];
                  console.log(miniiTarisanModContainer);

                  const miniitarisanmodnuud = await getDocs(
                    collection(db, "baiguulaga", userUid, "miniitarisanmodnuud")
                  );
                  miniitarisanmodnuud.forEach(async (miniiMod) => {
                    await console.log(miniiMod.data());
                    let modnuud = "";

                    modnuud = `
                                          <div class="modniiTuhai">
                                              <p id="onsarPro" >${
                                                miniiMod.data().HezeeTarisan
                                              }</p>
                                              <p class="YmarMod">${
                                                miniiMod.data().modniitorol
                                              }</p>
                                              <p class="HedenShirheg">${
                                                miniiMod.data().niithedenShirheg
                                              } ширхэг
                                              </p>
                                              <p class="HaanaTariv"> ${
                                                miniiMod.data().haana
                                              }</p>
                                            </div>
                                         `;
                    await console.log(modnuud);
                    miniiTarisanModContainer.innerHTML += modnuud;
                  });
                });
              }
            });
          }
        }
      });

      // document.getElementById("garah").addEventListener("click",()=>{
      //   // swal("haha")

      //     signOut(auth).then(async()=>{
      //       await swal("Амжилттай Бүртгэлээс гарлаа");
      //       location.reload();
      //     })
      //     .catch((err)=>{
      //       console.log("гарлаа");
      //     })

      // })

      let TuruuAnimatiom = new TimelineLite();

      TuruuAnimatiom.fromTo(
        "#tomMod",
        8,
        {
          width: 0 + "%",
          height: 0 + "%",
          bottom: 5 + "vh",
        },
        {
          width: 100 + "%",
          height: 90 + "%",
          bottom: 5 + "vh",
        },
        "-=1"
      );

      const ctx = document.getElementById("myChart").getContext("2d");
    </script>
  </body>
</html>
